import{E as r,d as y,r as f,v as n,o as k,P as z,w as o,k as a,u as O,R,g as h,W as g,b,t as D,p as j,a as A}from"./index-BPbcnTcR.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const N=async(c,d,p={},v=!0,i=".xlsx")=>{v&&r({title:"温馨提示",message:"如果数据庞大会导致下载缓慢哦，请您耐心等待！",type:"info",duration:3e3});try{const e=await c(p),u=new Blob([e]);if("msSaveOrOpenBlob"in navigator)return window.navigator.msSaveOrOpenBlob(u,d+i);const m=window.URL.createObjectURL(u),s=document.createElement("a");s.style.display="none",s.download=`${d}${i}`,s.href=m,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(m)}catch{}},M=c=>(j("data-v-61051e93"),c=c(),A(),c),P=M(()=>b("div",{class:"el-upload__text"},[h("将文件拖到此处，或"),b("em",null,"点击上传")],-1)),q={class:"el-upload__tip"},W=y({name:"ImportExcel"}),G=y({...W,setup(c,{expose:d}){const p=f(!1),v=f(1),i=f(!1),e=f({title:"",fileSize:5,fileType:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]}),u=l=>{e.value={...e.value,...l},i.value=!0},m=()=>{e.value.tempApi&&N(e.value.tempApi,`${e.value.title}模板`)},s=async l=>{let t=new FormData;t.append("file",l.file),t.append("isCover",p.value),await e.value.importApi(t),e.value.getTableList&&e.value.getTableList(),i.value=!1},S=l=>{const t=e.value.fileType.includes(l.type),_=l.size/1024/1024<e.value.fileSize;return t||r({title:"温馨提示",message:"上传文件只能是 xls / xlsx 格式！",type:"warning"}),_||setTimeout(()=>{r({title:"温馨提示",message:`上传文件大小不能超过 ${e.value.fileSize}MB！`,type:"warning"})},0),t&&_},E=()=>{r({title:"温馨提示",message:"最多只能上传一个文件！",type:"warning"})},U=()=>{r({title:"温馨提示",message:`批量添加${e.value.title}失败，请您重新上传！`,type:"error"})},V=()=>{r({title:"温馨提示",message:`批量添加${e.value.title}成功！`,type:"success"})};return d({acceptParams:u}),(l,t)=>{const _=n("el-button"),x=n("el-form-item"),C=n("upload-filled"),$=n("el-icon"),B=n("el-upload"),I=n("el-switch"),L=n("el-form"),T=n("el-dialog");return k(),z(T,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=w=>i.value=w),title:`批量添加${e.value.title}`,"destroy-on-close":!0,width:"580px",draggable:""},{default:o(()=>[a(L,{class:"drawer-multiColumn-form","label-width":"100px"},{default:o(()=>[a(x,{label:"模板下载 :"},{default:o(()=>[a(_,{type:"primary",icon:O(R),onClick:m},{default:o(()=>[h("点击下载")]),_:1},8,["icon"])]),_:1}),a(x,{label:"文件上传 :"},{default:o(()=>[a(B,{action:"#",class:"upload",drag:!0,limit:v.value,multiple:!0,"show-file-list":!0,"http-request":s,"before-upload":S,"on-exceed":E,"on-success":V,"on-error":U,accept:e.value.fileType.join(",")},{tip:o(()=>[g(l.$slots,"tip",{},()=>[b("div",q,"请上传 .xls , .xlsx 标准格式文件，文件最大为 "+D(e.value.fileSize)+"M",1)],!0)]),default:o(()=>[g(l.$slots,"empty",{},()=>[a($,{class:"el-icon--upload"},{default:o(()=>[a(C)]),_:1}),P],!0)]),_:3},8,["limit","accept"])]),_:3}),a(x,{label:"数据覆盖 :"},{default:o(()=>[a(I,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=w=>p.value=w)},null,8,["modelValue"])]),_:1})]),_:3})]),_:3},8,["modelValue","title"])}}}),K=F(G,[["__scopeId","data-v-61051e93"]]);export{K as I,N as u};
